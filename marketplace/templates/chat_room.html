{% extends 'base.html' %}
{% load i18n %}

{% block title %}{{ conversation.item.title }}{% endblock %}

{% block content %}
<div class="space-y-4">

  <div class="bg-white border border-gray-200 rounded-xl shadow">
    <div class="bg-gray-800 text-white px-4 py-3 rounded-t-xl">
      <h5 class="text-lg font-semibold">
        {% trans "Chat about" %} “{{ conversation.item.title }}”
      </h5>
    </div>

    <div class="p-4">
      <div class="border border-gray-300 bg-gray-50 rounded-lg p-4 h-80 overflow-y-auto space-y-4">

        {% for msg in messages %}
          <div class="pb-4 border-b border-gray-200">
            <div class="flex justify-between items-center">
              <strong>
                <a href="{% url 'user_profile' msg.sender.user_id %}"
                   class="text-jordan hover:underline">
                  {{ msg.sender.username }}
                </a>
              </strong>
              <small class="text-gray-500">{{ msg.created_at|date:"Y-m-d H:i" }}</small>
            </div>
            <p class="mt-2 text-gray-800">{{ msg.body }}</p>
          </div>
        {% empty %}
          <p class="text-gray-500">{% trans "No messages yet." %}</p>
        {% endfor %}

      </div>

      <form method="post" class="mt-4 space-y-2">
        {% csrf_token %}
        <label for="body" class="font-semibold">{% trans "Message" %}</label>
        <textarea id="body" name="body" rows="3"
                  class="w-full border border-gray-300 rounded-lg p-2"
                  placeholder="{% trans 'Write a message…' %}"></textarea>

        <div class="flex justify-end">
          <button type="submit"
                  class="bg-jordan text-white px-4 py-2 rounded hover:opacity-90">
            {% trans "Send" %}
          </button>
        </div>
      </form>

      <div class="mt-4">
        <a href="{% url 'item_detail' conversation.item.id %}"
           class="inline-block border border-jordan text-jordan px-4 py-2 rounded hover:bg-jordan hover:text-white transition">
          {% trans "Back to announcement" %}
        </a>
      </div>
    </div>
  </div>

</div>
{% endblock %}
