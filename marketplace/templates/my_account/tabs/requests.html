{# templates/my_account/tabs/requests.html #}
{% load i18n %}

<div class="requests-tab">

  <div class="requests-head">
    <div class="requests-title-row">
      <h2 class="requests-title">ğŸ›’ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>

      <div class="requests-actions">
        <div class="requests-count">
          Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: <span id="requestsCount">{% if my_requests %}{{ my_requests|length }}{% else %}0{% endif %}</span>
        </div>

        <a href="#" class="requests-add-btn">
          Ø£Ø¶Ù Ø·Ù„Ø¨
        </a>
      </div>
    </div>
  </div>

  <div class="requests-list" id="requestsList">
    {% if my_requests %}
      {% for req in my_requests %}
        <article class="req-card req-status-{{ req.status|default:'active' }}">
          <div class="req-body">
            <div class="req-topline">
              <span class="req-cat">{{ req.category|default:"Ø¨Ø¯ÙˆÙ† Ù‚Ø³Ù…" }}</span>

              {% if req.featured %}
                <span class="badge badge-featured">â­ Ù…Ù…ÙŠØ²</span>
              {% endif %}
            </div>

            <div class="req-idline">
              <span class="req-id">ğŸ†” Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: <span class="req-id-num">{{ req.id }}</span></span>

              {% if req.status == "active" %}
                <span class="badge badge-active">ğŸŸ¢ Ù…ÙØ¹Ù‘Ù„</span>
              {% elif req.status == "pending" %}
                <span class="badge badge-pending">ğŸŸ¡ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
              {% elif req.status == "rejected" %}
                <span class="badge badge-rejected">ğŸ”´ Ù…Ø±ÙÙˆØ¶</span>
              {% endif %}
            </div>

            <div class="req-title-row">
              <h3 class="req-title-text">{{ req.title }}</h3>
              <div class="req-budget">ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©: {{ req.budget }} Ø¯.Ø£</div>
            </div>

            <div class="req-meta">
              <span>ğŸ“ {{ req.city|default:"â€”" }}</span>
              <span>ğŸ“… {{ req.date|default:"â€”" }}</span>
              <span>ğŸ” Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: {{ req.condition|default:"â€”" }}</span>
              <span>ğŸ‘ï¸ {{ req.views|default:0 }} Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
            </div>

            {% if req.status == "rejected" and req.rejectReason %}
              <p class="req-reject">â— Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶: <b>{{ req.rejectReason }}</b></p>
            {% endif %}
          </div>

          <div class="req-actions">
            <a href="{{ req.editUrl }}"
               class="pill pill-blue {% if req.status == 'pending' %}is-disabled{% endif %}">
              âœï¸ ØªØ¹Ø¯ÙŠÙ„
            </a>

            <button type="button"
                    class="pill pill-red {% if req.status == 'pending' %}is-disabled{% endif %}"
                    onclick="myAccountDeleteRequest?.({{ req.id }})">
              âŒ Ø­Ø°Ù
            </button>

            <button type="button"
                    class="pill pill-green {% if req.status != 'active' %}is-disabled{% endif %}"
                    onclick="myAccountRepublishRequest?.({{ req.id }})">
              ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ù†Ø´Ø±
            </button>

            {% if req.status != "active" %}
              <button type="button" class="pill pill-orange is-disabled">â­ ØªÙ…ÙŠÙŠØ²</button>
            {% else %}
              {% if req.featured and req.featuredDaysLeft|default:0 > 0 %}
                <button type="button" class="pill pill-orange is-disabled">â­ ØªÙ…ÙŠÙŠØ²</button>
              {% else %}
                <button type="button"
                        class="pill pill-orange"
                        onclick="openHighlightModal?.('request', {{ req.id }})">
                  â­ ØªÙ…ÙŠÙŠØ²
                </button>
              {% endif %}
            {% endif %}
          </div>
        </article>
      {% endfor %}
    {% else %}
      <div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>
    {% endif %}
  </div>

</div>

{# Optional JSON for requests.js #}
{# <script id="myRequestsData" type="application/json">{{ my_requests_json|safe }}</script> #}
